<!DOCTYPE html>
<html lang="en">
  <head>
    <style>
      .CodeMirror-foldmarker {    
      font-family: arial;
      }
      .CodeMirror-foldgutter {
      width: .7em;
      }
      .CodeMirror-foldgutter-open,
      .CodeMirror-foldgutter-folded {
      color: #555;
      cursor: pointer;
      }
      .CodeMirror-foldgutter-open:after {
      content: "\25BE";
      }
      .CodeMirror-foldgutter-folded:after {
      content: "\25B8";
      }
    </style>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="The K Language portal.">
    <meta name="author" content="">

    <title>The K Language</title>
  </head>

  <body>

    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">K</a>
        </div>
	
	<div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="index.html">Home</a></li>
            <li class="active"><a href="tutorial.html">Tutorial</a></li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Examples<span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="#" onclick="loadExample(editor,'examples/Shapes.k')">Shapes.k</a></li>
                <li><a href="#" onclick="loadExample(editor,'examples/sm.k')">sm.k</a></li>
                <li><a href="#" onclick="loadExample(editor,'examples/borges.k')">borges.k</a></li>
		<li><a href="#" onclick="loadExample(editor,'examples/prepost.k')">prepost.k</a></li>
		<li><a href="#" onclick="loadExample(editor,'examples/Fruits.k')">Fruits.k</a></li>
		<li><a href="#" onclick="loadExample(editor,'examples/lightswitch.k')">lightswitch.k</a></li>
		<li><a href="#" onclick="loadExample(editor,'examples/scheduling.k')">scheduling.k</a></li>
		<li><a href="#" onclick="loadExample(editor,'examples/planning-simple.k')">planning-simple.k</a></li>
                <li role="separator" class="divider"></li>
                <li><a href="#" onclick="loadExample(editor,'examples/GravityScience.k')">GravityScience.k</a></li>
                <li><a href="#" onclick="loadExample(editor,'examples/DSN_Pass.k')">DSN_Pass.k</a></li>
                <!--<li role="separator" class="divider"></li>
                    <li class="dropdown-header">Nav header</li>
                <li><a href="#">Separated link</a></li>
                <li><a href="#">One more separated link</a></li>-->
                  </ul>
            </li>

            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Download<span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="http://niks.jpl.nasa.gov/k/k-osx.tgz" >K for OSX</a></li>
                <li><a href="http://niks.jpl.nasa.gov/k/k-win.zip">K for Windows</a></li>
	      </ul>
	    </li>
	    
          </ul>
        </div>
      </div>
    </nav>


    <div class="jumbotron">

    </div>
    
    <div class="container">

      <!-- Example row of columns -->
      <div class="row">
	<div class="col-md-6" style="padding-right:20px; border-right: 2px solid #ccc; overflow:scroll; height:720px;">


  
 	  <h3>Introduction </h3>
	  <a name="introduction"></a>
	  <p>
	    Welcome to <font color=red>K</font>. K is a textual
	    language intended to be used by modelers and/or
	    programmers, for system design and implementation.  The
	    motivation for K is based on the need for a textual
	    language that provides the right set of constructs and
	    tools to model, verify, and implement. Currently K is
	    integrated with SMT solvers to be able to:
	    <ul>
	      <li> Prove that classes with given constraints are
	      satisfiable. If your constraints are specified at the
	      top level without any classes, that is fine as well. The
	      constraints will be proven satisfiable at the top level.
	      <li> For each satisfiable class, provide an example of
	      an instance with satisfying assignments to the
	      properties. Note, this is not the only possible solution
	      to the class, rather one of the potentially many
	      solutions. If no solution is possible (i.e. the class is
	      NOT satisfiable), then K will provide you a
	      corresponding report.
	    </ul>

	    In order to use K, one only has to write K code in the
	    editor and then submit it for analysis using the 'Analyze'
	    button. If there are errors in the code, they will be
	    reported in the results window, otherwise the result of
	    the consistency checking and instance generation will be
	    reported in a systematic manner.

	    For a binary drop for your development environment or any
	    other questions/concerns please contact
	    <a href="mailto:rahulku@jpl.nasa.gov">Rahul.Kumar@jpl.nasa.gov</a>
	    or <a href="mailto:klaus.havelund@jpl.nasa.gov">Klaus.Havelund@jpl.nasa.gov</a>.
	    <br><br>
	    <a href="#faq">Frequently Asked Questions</a>
	  </p>

	  <h3>Primitive Types</h3> 

	  K currently has the following primitive types: Int, Real,
	  Char, String, Bool. <!-- In addition to the primitive types, K
	  also provides the Unit literal '()'. Unit can be used to
	  represent the existence of something without it having any
	  particular value. -->
	  
	  <h3>Classes</h3>
	  <p>
	  Classes are a basic method of encapsulating all relevant
	  information, properties, functions etc. about a single
	  entity. They provide the simplest approach for abstracting a
	  concept or concrete entity and representing it in your
	  model/program. The follwing figure shows an example of
	  classes being used to model shapes. We will use this figure
	  to dicuss some basic concepts of K in the tutorial.
	  </p>

	  <p style="border: 1px solid #ccc;">	   
	    <a class="btn-xs btn-default" href="#" role="button" onclick="loadExample(editor,'examples/ShapesTutorial.k');">Load in editor</a>
	    <textarea id="in1" name="in1"></textarea>
	  </p>

	  <h3>Properties</h3>
	  <p>
	    Properties are attributes that you want associated with a
	    particular concept. For example, each Shape always has a
	    certain number of sides associated with it. Therefore,
	    sides is a property of class Shape. This declaration can
	    be found on line 4 of the Shapes example. It should be
	    noted that properties can be declared inside classes, or
	    at the outer most level. For example, the property 't1' at
	    line 28 is declared at the outer most class.
	  </p>
	  
	  <h4>Modifiers</h4>
	  <p>
	    Each property may also have certain modifiers present
	    before it's name. These are to specify additional
	    behaviors. Certain of these modifiers can also be combined
	    together.

	      <table class="table table-bordered">
		<tbody>
		  <thead>
		    <tr>
		      <th>Modifier</th>
		      <th>Description</th>
		    </tr>
		  <tr>
		    <td>val</td>
		    <td>read only property</td>
		  </tr>
		  <tr>
		    <td>var</td>
		    <td>read and write property</td>
		  </tr>
		  <tr>
		    <td>ordered (collection)</td>
		    <td>property is dictated by a certain ordering</td>
		  </tr>
		  <tr>
		    <td>unique (collection)</td>
		    <td>no duplicate members in this property</td>
		  </tr>
		  <tr>
		    <td>part</td>
		    <td>property is a part of another object</td>
		  </tr>
		  <tr>
		    <td>source</td>
		    <td>source property of an association</td>
		  </tr>
		  <tr>
		    <td>target</td>
		    <td>target property of an association</td>
		  </tr>
		</tbody>
              </table>

	      The following code snippet shows various properties
	      declared with modifiers present in them. 'MY_CONSTANT'
	      is a variable that is read only, whereas the 'y' Real is
	      read and write (can be modified). Leaving out the 'var'/'val'
              modifier is equivalent to providing the 'val' modifier. 
              'ages' is a bag of Integers, and is ordered (a list essentially).
              Here the multiplicity '[*]' stands for '0 or more'. 
              'cars' is a set of Cars. Finally 'transactions'
              is an ordered set.
	  </p>
	  <p style="border: 1px solid #ccc;">	   
	    <textarea id="in2" name="in2">
val MY_CONSTANT : Int
var y : Real
ordered ages : Int [*]
unique cars : Car [*]
ordered unique transactions : Transaction [*]
</textarea>	      
	    </p>

	  <h3>Constraints</h3>
	  <p>
	    Constraints, or requirements can be imposed on classes (or
	    at the outer most level). These are used to restrict the
	    values of properties. Constraints always evaluate to a
	    Boolean value - true or false. For example, in the Angle
	    class, on line 9, we restrict the value of the angle to
	    be between 0 and 360 degrees. Now every instance of the
	    Angle class will have the angle value between 0 and 360
	    degrees.
	  </p>

	  <h3>Inheritance</h3>
	  <p>
	    K supports inheritance (multiple as well as single) between
	    classes. Inheritance works in a manner similar to other
	    languages such as Java, with the one difference that in K,
	    sub-classes not only inherit the properties and
	    functions of the parent class(es) but also the
	    constraints. For example, class TAngle inherits from class
	    Angle. As a result, it already has a function 'eq' and the
	    property 'value' from class Angle. Additionally, it also
	    has the requirement that the value is to be between 0 and
	    360. The TAngle class further restricts the value of the
	    angle to be less than 180 degrees, which is fine since
	    this is not conflicting with the parent class
	    constraints. Whenever constraints are inherited, and added
	    upon by sub-classes, class consistency may be
	    compromised.
	  </p>

	  <h3>Class Types</h3>
	  <p> It should be noted that each declared class also becomes
	  a 'type' in K's world. For example, class Angle creates a
	  new type, that can be used as the type for properties or
	  function parameters. Lines 24 and 25 use the TAngle type as
	  the type for properties 'a' and 'b'. 
	  </p>

	  <h3>Packages and Imports</h3>
	  <p>
	    Optionally, you may include a package declaration such as
	    the declaration on line 1 of the shapes example. This
	    declaration specifies the package that this file belongs
	    to. This is useful when you want to be able to import it
	    in other K models using the 'import package.xyz'
	    declaration. Currently our language supports this and we
	    are working out the finer details of building tool support
	    for this. It should be available very soon.
	  </p>

	  <h3>Functions</h3>
	  <p>
	    K supports the definition of functions, which essentially
	    are named parameterized expressions.  A function can be
	    applied to a list of arguments and return a
	    value. Functions can make our models more modular and
	    allow us refer to the same expression in different
	    contexts for different parameters, by just calling the
	    function by name with the right parameters.
	    
	    A function definition conists of a function name, a list
	    of parameters (name and type), a return type, and finally
	    a body: an expression enclosed in curly brackets {...}
	    representing the value returned by the function.
	    
	    The following example illustrates a class providing three
	    functions, one for computing the minimal value of two
	    values, one for computing the maximal value, and one for
	    computing the absolute value of a value. We have also
	    provided a class extending the MathFunctions class so we
	    can call the functions.
	  </p>
	  
	  <p style="border: 1px solid #ccc;">	   
	    <textarea id="in3" name="in3">
class MathFunctions {
  fun min(x:Int,y:Int): Int {
    if x < y then x else y
  }

  fun max(x:Int,y:Int): Int {
    if x < y then y else x
  }

  fun abs(x:Int):Int {
    if x < 0 then -x else x
  }
}

class UseMathFunctions extends MathFunctions {
  four : Int = min(4,5)
  five : Int = max(4,5)
  six  : Int = abs(10 - 16)
}
	    </textarea>
	  </p>
	  
	  <p>
	    Suppose you want to define a function, whos body is
	    composite expression consisting of several sub-expressions, as for
	    example is shown in the following class:
	  </p>
	  <p style="border: 1px solid #ccc;">	   
	    <textarea id="in4" name="in4">
class Algebra {
  fun formula(x:Real):Real {
    2.0 * (x * x * x) + 3.0 * (x * x) + 5.0 * x + 1.0 
  }
}
	    </textarea>
	  </p>
	  <p>
	    We might want to clarify calculation by dividing it into
	    steps. This can be done by inserting appropriate
	    property definitions in the body of the function before
	    the returning expression, as is done in the following
	    class. Note that this approach has not (important)
	    effect on the analysis we can perform on this
	    model. This is only for the purpose of increasing
	    readability, although it of course can be debated whether
	    this has been achieved here.
	  </p>
	  <p style="border: 1px solid #ccc;">	   
	    <textarea id="in5" name="in5">
class AlgebraPlus {
  fun formula(x:Real):Real {
    a : Real = 2.0
    b : Real = 3.0
    c : Real = 5.0
    k : Real = 4.0
    x2: Real = x * x
    x3: Real = x * x2
 
    a * x3 + b * x2 + c * x + k
  }
}

class UseAlgenraPlus extends AlgebraPlus {
  fourtytwo : Real = formula(2.0)
}
	    </textarea>
	  </p>

	  <h3>Function Specifications</h3>
	  <p>
	    Whenever we write a function (or any formal text for that
	    matter) there is a risk of introducing errors. K supports
	    a mechanism for potecting against such errors when defining
            functions, namely pre- and post-conditions, also known as
            design-by-contract in programming theory.
	    
	    The idea is to equip a function definition with an
	    additional specification of what the expected result must
	    satisfy (the post-condition) and under what circumstances
	    this will hold (the pre-condition). The following example
	    illustrates our 'min' function from before, but now
	    equipped with a post-condition stating that the result
	    must be one of the two arguments, and in addition must be
	    the smallest of these.
	  </p>

	  <p style="border: 1px solid #ccc;">	   
	    <textarea id="in6" name="in6">
class CorrectMathFunctions {
  fun min(x:Int,y:Int): Int 
    pre true
    post 
      ($result = x ||  $result = y) && 
       $result <= x && $result <= y
  {
    if x < y then x else y
  }
}
	    </textarea>
	  </p>

	  <p>
	    The pre-condition is in this case true. It can be left out
	    in this case, we have just shown it to illustrate the 
            pre-condition concept.
	    
	    Try as an experiment to replace the body of this min
	    function with the body of the max function above, and
	    observe how the prover detects this by stating that the
	    model is NOT satisfiable.
	  </p>
	    
	  <h3>Collections and Tuples</h3>
	  <p>
	    So far we have seen examples of the following kinds of
	    types: primitive types and class types (identifiers
	    representing classes). The type Int for example represents
	    the set of integers, and the class Shape represents the
	    set of Shape objects. K offers in addition to these forms
	    of types also tuples (cartesian product) and collections
	    (sets, bags, and sequences). Let us illustrate this with an
	    example.
	    
	    The following class defines what a line is (basic geometry), 
            first its semantics as an infinite set of points, and next in terms
	    of its finite representation as an equation.
	    
	    A point is a pair (a tuple) of real numbers. The type
	    constructor T1 * T2 yields the tuple type consisting of
	    valus of the form: Tuple(v1,v2) where v1 is of type T1 and
	    v2 is of type T2. Semantically, a line is an infinite set
	    of points.
	    
	    A line, can be characterized by the finite description
	    consisting of a function of the form 'y = ax + b' for two
	    constants a and b. This is here modeled by the two
	    constants a and b and the function y, which computes the
	    y-value corresponding to an x-value. We finally state that
	    the set of points is the set of tuples Tuple(x,y(x)) where
	    x is a real number.  The constructs Set{...} is a set
	    comprehension expression and denotes the set of
	    Tuple(x,y(x)) where x is a Real number, and such that true holds
	    (the condition). In general one can write any Boolean expression
            as the condition.
	  </p>
	  
	  <p style="border: 1px solid #ccc;">	   
	    <textarea id="in7" name="in7">
class Line {
  points : Set[Real * Real] 

  a : Real
  b : Real

  fun y(x:Real):Real {
    a * x + b
  }

  req points = Set{ Tuple(x,y(x)) | x : Real :- true} 
}
	    </textarea>
	  </p>

          <P>
          <font color=red>Note: currently K does not support analysis of collections! This will be supported soon.</font>
          </p>

	  <h3>Annotations</h3>
	  <p>
	    K supports annotation of class, function, and property definitions as well as constraints 
	    with additional information. In the following  example, two annotation kinds 'id' and 'doc' 
	    are defined (annotation kinds must be defined as the first thing after any package and import declarations,
            and before class, property, function, and constraint declarations). 
	    The annotation kind 'id' is defined to have type Int (an integer) while the annotation kind 'doc' is 
	    defined to have type String. These annotations can now be used to annotate model elements, as shown in 
	    the following.
	  </p>
	  <p style="border: 1px solid #ccc;">	   
	    <textarea id="in8" name="in8">
annotation id : Int
annotation doc : String

@id(42)
@doc("The basic shape type.")

class Shape3 {
  sides : Int
}

@id(43)
@doc("represents an angle")

class Angle3 {
  @doc("the angle")
  value : Int

  @doc("angle must be well-formed.")
  req value >= 0 && value <= 360
}
	    </textarea>
	  </p>
	  <p>
	    Annotations (the application of an annotation kind) are
	    written right before the element being annotated (spaces
	    and newlines are allowed in between).  Here the class
	    Shape is annotated with an 'id' annotation, carrying the
	    integer value 42, and with the 'doc' annotation carrying a
	    documentation string. Likewise, class Angle is annotated
	    with 'id' 43 and a documentation string. The property
	    'value' as well as the constraint in class Angle are both
	    annotated with documentation strings.

	    Annotations are different from comments in that they can
	    be processed by tools. They have, however, no impact on
            the analysis performed on K models (at this point in time).
	    
	  </p>

	  <h3>User-defined Keywords</h3>
	  <p>
	    K to a limited extent supports creating domain-specific
	    keywords for defining sub-classes of a
	    class. Consider the situation where we define a class of
	    which we want to define one or more sub-classes that
	    inherit from it. Let's look at a cut down version of the
	    shapes example, where we create a Trinangle class and a
	    Rectangle class sub-classing the Shape class:
	  </p>
	  
	  <p style="border: 1px solid #ccc;">	   
	    <textarea id="in9" name="in9">
class Shape {
  sides : Int
}

class Triangle extends Shape {
  req sides = 3
}

class Rectangle extends Shape {
  req sides = 4
}
	    </textarea>
	  </p>
	  
	  <p>
	    Writing 'class ... extends Shape' repeatedly may appear
	    somewhat verbose, and the fact that we are defining shapes
	    may not stand out clearly in the text. K allows us to
	    define a 'shape' keyword, and write the above model as
	    follows, but with the exact same meaning:
	  </p>

	  <p style="border: 1px solid #ccc;">	   
	    <textarea id="in10" name="in10">
class <shape> Shape {
  sides : Int
}

shape Triangle {
  req sides = 3
}

shape Rectangle {
  req sides = 4
}
	    </textarea>
	  </p>

	  <p>
	    The Shape class itself has been defined with the addition
	    of a keyword 'shape' (can be any name) in angle-brackets
	    <...>. This allows us to use this keyword to define the
	    two sub-classes as above, having the meaning as in the
	    first specifiction.
	  </p>

	  <h3>Type Checker</h3>
	  <p>The K type checker will statically perform analysis and
	  type checking on your code to ensure that certain basic
	  conditions are met before any other analysis can be
	  performed. These include syntactic and certain semantic
	  checks. Please note that error messaging is being improved
	  even as you read this.</p>

	  <h3>Class Consistency Checing Output</h3>
	  <p>
	    K is currently integrated with SMT solving techniques to
	    provide you a proof of whether the classes as specified in
	    your model are satisfiable (consistent) or not. If they
	    are, an instance for each class will be provided as
	    output. If there are top level instances declared for a
	    class (for example, 't1' on line 28 of the shapes example
	    above), the instances will be easier to recognize in the output.
            These instances are only possible solutions and not the only
	    solutions. An instance may, however, be the only solution, if your specified
	    requirements (constraints) only allow one solution.

	    If the class(es) are not satisfiable, K will provide you
	    an error message saying that the classes are not
	    satisfiable.

	  </p>

	  <h3>Frequently Asked Questions</h3>
	  <a name="faq"></a>
	  <p>
	    <span class="label label-danger">Q.</span> Can I use this on a Mac/Windows/...?
	    <br>
	    <span class="label label-success">A.</span> Yes. We have distributions for Linux, Windows, and Mac. All you require is Java. 
	  </p>
	  <p>
	    <span class="label label-danger">Q.</span> Can I produce multiple instances for 1 class? 
	    <br>
	    <span class="label label-success">A.</span> Yes. Just declare multiple instances at the top most level. 
	  </p>
	  <p>
	    <span class="label label-danger">Q.</span> Can I specify a 'distribution' of the solutions for the instances? 
	    <br>
	    <span class="label label-success">A.</span> Currently, no. We are hard at work for providing you a solution for this.
	  </p>

	</div>
	<div class="col-md-6">
	    <p>
	      <textarea id="code" name="code"></textarea>
	    </p>
	      <hr>
	    <p>
  	      <div class="pull-right">   <canvas width="27" height="27" id="myCanvas"></canvas> </div>
	      <a class="btn btn-warning center-block" href="#" role="button" onclick="doWork()">Analyze</a>
	    </p>
	      <hr>
	    <p>
	      <textarea id="result" name="result"></textarea>
	    </p>
	</div>
	
	<hr>
	
	<footer>
	  <p>
	    &copy; 2015 by the California
	    Institute of Technology. ALL RIGHTS RESERVED. United States Government
	    Sponsorship acknowledged. Any commercial use must be negotiated with
	    the Office of Technology Transfer at the California Institute of
	    Technology.
	  </p>
	</footer>
      </div> <!-- /container -->
      

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
    
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

    <link rel="stylesheet" href="CodeMirror-master/lib/codemirror.css">
    <link rel="stylesheet" href="CodeMirror-master/theme/ttcn.css">
    <link rel="stylesheet" href="CodeMirror-master/theme/paraiso-light.css">
    <link rel="stylesheet" href="CodeMirror-master/theme/neat.css">
    <script src="CodeMirror-master/lib/codemirror.js"></script>
    <script src="CodeMirror-master/mode/shell/shell.js"></script>
    <script src="CodeMirror-master/addon/edit/matchbrackets.js"></script>
    <script src="CodeMirror-master/mode/k/clike.js"></script>
    <script src="CodeMirror-master/addon/fold/foldcode.js"></script>
    <script src="CodeMirror-master/addon/fold/foldgutter.js"></script>
    <script src="CodeMirror-master/addon/fold/brace-fold.js"></script>
    <script src="CodeMirror-master/addon/fold/xml-fold.js"></script>
    <script src="CodeMirror-master/addon/fold/comment-fold.js"></script>

    <link rel="stylesheet" href="CodeMirror-master/addon/dialog/dialog.css">
    <link rel="stylesheet" href="CodeMirror-master/addon/search/matchesonscrollbar.css">
    <script src="CodeMirror-master/addon/dialog/dialog.js"></script>
    <script src="CodeMirror-master/addon/search/searchcursor.js"></script>
    <script src="CodeMirror-master/addon/search/search.js"></script>
    <script src="CodeMirror-master/addon/scroll/annotatescrollbar.js"></script>
    <script src="CodeMirror-master/addon/search/matchesonscrollbar.js"></script>

    <script>
      var editor = CodeMirror.fromTextArea(document.getElementById("code"), {
      lineNumbers: true,
      matchBrackets: true,
      theme: "ttcn",
      mode: "text/x-k",
      foldGutter: {
      rangeFinder: new CodeMirror.fold.combine(CodeMirror.fold.brace, CodeMirror.fold.comment)
      },
      extraKeys: {"Ctrl-Q": function(cm){ cm.foldCode(cm.getCursor()); }},
      gutters: ["CodeMirror-linenumbers", "CodeMirror-foldgutter"]
      });

      var in1 = CodeMirror.fromTextArea(document.getElementById("in1"), {
      lineNumbers: true,
      theme: "neat",
      mode: "text/x-k",
      readOnly: true,
      foldGutter: {
      rangeFinder: new CodeMirror.fold.combine(CodeMirror.fold.brace, CodeMirror.fold.comment)
      },
      extraKeys: {"Ctrl-Q": function(cm){ cm.foldCode(cm.getCursor()); }},
      gutters: ["CodeMirror-linenumbers", "CodeMirror-foldgutter"]
      });
      var in2 = CodeMirror.fromTextArea(document.getElementById("in2"), {
      lineNumbers: true,
      theme: "neat",
      mode: "text/x-k",
      readOnly: true,
      foldGutter: {
      rangeFinder: new CodeMirror.fold.combine(CodeMirror.fold.brace, CodeMirror.fold.comment)
      },
      extraKeys: {"Ctrl-Q": function(cm){ cm.foldCode(cm.getCursor()); }},
      gutters: ["CodeMirror-linenumbers", "CodeMirror-foldgutter"]
      });
      var in3 = CodeMirror.fromTextArea(document.getElementById("in3"), {
      lineNumbers: true,
      theme: "neat",
      mode: "text/x-k",
            readOnly: true,
      foldGutter: {
      rangeFinder: new CodeMirror.fold.combine(CodeMirror.fold.brace, CodeMirror.fold.comment)
      },
      extraKeys: {"Ctrl-Q": function(cm){ cm.foldCode(cm.getCursor()); }},
      gutters: ["CodeMirror-linenumbers", "CodeMirror-foldgutter"]
      });
      var in4 = CodeMirror.fromTextArea(document.getElementById("in4"), {
      lineNumbers: true,
      theme: "neat",
      mode: "text/x-k",
      readOnly: true,
      foldGutter: {
      rangeFinder: new CodeMirror.fold.combine(CodeMirror.fold.brace, CodeMirror.fold.comment)
      },
      extraKeys: {"Ctrl-Q": function(cm){ cm.foldCode(cm.getCursor()); }},
      gutters: ["CodeMirror-linenumbers", "CodeMirror-foldgutter"]
      });
      var in5 = CodeMirror.fromTextArea(document.getElementById("in5"), {
      lineNumbers: true,
      theme: "neat",
      mode: "text/x-k",
      readOnly: true,
      foldGutter: {
      rangeFinder: new CodeMirror.fold.combine(CodeMirror.fold.brace, CodeMirror.fold.comment)
      },
      extraKeys: {"Ctrl-Q": function(cm){ cm.foldCode(cm.getCursor()); }},
      gutters: ["CodeMirror-linenumbers", "CodeMirror-foldgutter"]
      });
      var in6 = CodeMirror.fromTextArea(document.getElementById("in6"), {
      lineNumbers: true,
      theme: "neat",
      mode: "text/x-k",
      readOnly: true,
      foldGutter: {
      rangeFinder: new CodeMirror.fold.combine(CodeMirror.fold.brace, CodeMirror.fold.comment)
      },
      extraKeys: {"Ctrl-Q": function(cm){ cm.foldCode(cm.getCursor()); }},
      gutters: ["CodeMirror-linenumbers", "CodeMirror-foldgutter"]
      });
      var in7 = CodeMirror.fromTextArea(document.getElementById("in7"), {
      lineNumbers: true,
      theme: "neat",
      mode: "text/x-k",
      readOnly: true,
      foldGutter: {
      rangeFinder: new CodeMirror.fold.combine(CodeMirror.fold.brace, CodeMirror.fold.comment)
      },
      extraKeys: {"Ctrl-Q": function(cm){ cm.foldCode(cm.getCursor()); }},
      gutters: ["CodeMirror-linenumbers", "CodeMirror-foldgutter"]
      });
      var in8 = CodeMirror.fromTextArea(document.getElementById("in8"), {
      lineNumbers: true,
      theme: "neat",
      mode: "text/x-k",
      readOnly: true,
      foldGutter: {
      rangeFinder: new CodeMirror.fold.combine(CodeMirror.fold.brace, CodeMirror.fold.comment)
      },
      extraKeys: {"Ctrl-Q": function(cm){ cm.foldCode(cm.getCursor()); }},
      gutters: ["CodeMirror-linenumbers", "CodeMirror-foldgutter"]
      });
      var in9 = CodeMirror.fromTextArea(document.getElementById("in9"), {
      lineNumbers: true,
      theme: "neat",
      mode: "text/x-k",
      readOnly: true,
      foldGutter: {
      rangeFinder: new CodeMirror.fold.combine(CodeMirror.fold.brace, CodeMirror.fold.comment)
      },
      extraKeys: {"Ctrl-Q": function(cm){ cm.foldCode(cm.getCursor()); }},
      gutters: ["CodeMirror-linenumbers", "CodeMirror-foldgutter"]
      });
      var in10 = CodeMirror.fromTextArea(document.getElementById("in10"), {
      lineNumbers: true,
      theme: "neat",
      mode: "text/x-k",
      readOnly: true,
      foldGutter: {
      rangeFinder: new CodeMirror.fold.combine(CodeMirror.fold.brace, CodeMirror.fold.comment)
      },
      extraKeys: {"Ctrl-Q": function(cm){ cm.foldCode(cm.getCursor()); }},
      gutters: ["CodeMirror-linenumbers", "CodeMirror-foldgutter"]
      });

      in1.setSize(null,"570");
      in2.setSize(null,"130");
      in3.setSize(null,"430");
      in4.setSize(null,"140");
      in5.setSize(null,"350");
      in6.setSize(null,"230");
      in7.setSize(null,"270");
      in8.setSize(null,"430");
      in9.setSize(null,"250");
      in10.setSize(null,"250");
  
      var results = CodeMirror.fromTextArea(document.getElementById("result"), {
      lineNumbers: false,
      theme: "paraiso-light",
      mode: "shell",
      readOnly: true
      });

      editor.setValue("");
      editor.setSize(null,"300");

      results.setSize(null,"300");
      results.setValue("Results will be displayed here.");
      results.readOnly = true;

      function loadExample(e,name){
      results.setValue('');
      $.ajax({
       url: "http://niks.jpl.nasa.gov/K/k/" + name,
      success: function(data, status, xhr) {
      e.setValue(data);
      },
      error: function(data, status, xhr) {
      alert("Error when loading example. Please try again.");
      }
      });
      return false;
      }

      $('canvas').hide();
      
      var working = 0;
      function doWork() {
      if(working == 1) return;
      working = 1;
      $('canvas').show();
      results.setValue('');
      $.ajax({
      type: "post",
      data: editor.getValue(),
      url: "http://niks.jpl.nasa.gov/k-service",
      success: function(data, status, xhr) {
      results.setValue(data);
      working = 0;
      $('canvas').hide();
      },
      error: function(data, status, xhr) {
      $('canvas').hide();
      alert("Error while executing. Please try again.");
      working = 0;
      }
      });
      return false;
      }
      
      editor.setValue("-- Load sample code from the tutorial by scrolling down, or \n-- from the examples drop down list provided \n-- in the navigation bar.");

      loadExample(in1, "examples/ShapesTutorial.k");


    </script>
        <script type="text/javascript">
            var cog = new Image();
            function init() {
                cog.src = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABsAAAAbCAYAAACN1PRVAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABK1JREFUeNqMVt1ZGzkUvVfS4IW1l8GO82w6IBXE7mCpAFMB+Pt4Z6iApALcAe4AU0HoAJfg7BPYHinnXmmciX+y0YdmJHnQ0bk/R5cvh5cUyFPwRD4EChgEvGWMB36R3+JaiTkmD5gOs8yNb25uLlerFf1pM2yIGA82TEY7xow1oj4GBU6S6yywPNG4JwDH+XGv0Whs7ndN8n97mmPsLCSYgy7ImPQE/pFDyAF+7L0fgTNFUDBcLal90taD1doQ/T6NT9DnW8zkT+jJuQVYukG3hifCVk/L3JOxMBa8VVlSp9MhHKLaB+zpNo1fdgEpmByuMqUAV5viOQLwXNax9KBAFNEEpN1pUwnQmvl6aTza6zNjrCKaymeyOdYAMgfg18iG4T/qw+AC94zvpzDjcwqOXo3VGH26H0xMZ7jPxgT0R2zUi4BYt6bAfEbJvJFZKA4ODgZ5nhcJLE9mk35X21vWC/TXKmiwr2xszoQd/PQv3t/QCzY2twpqBpb5FKOp+hCgzWaTWq0W1Xx0ij5An9WC5VtiLMwvNBrVaSGMvQk5jHQVPN7sb0HzAtE+QJrNgrcUNEARieWCut0ugR0tl8sKcJ5Ahc3jRviPK8ZGTaaBwGKyT+gTiwM4a3Jrba6MbeVXo5F4kp9shn29ndUYC9vLirGDXzRhrYhD8DME5Hkg22df5rDYS/RXmVIsaP/Q/SXs600YnifTjbeSWliEdTYb3QyTqYfdDKTL4B1KS6tVqf6SgGq3P9BvZGpvNIrPCgVKZlGlCDQDxJiCjVppCab05DJHzb+b1Gm36X80cVjLuzozexs0f6IgRkA5XRhzIixRL1+IzhwdHVHrn1Y9oXe1i10aKT6bGGhg1CKK+cT0zCGCs0oXTIogybJMw/779//o48duMvnO9rzLn+Kz8wgS5Shqo4njpCoOQA5Ajb8adHh4SMvVghaLhYb/HsBip88krNVISSEigOlhjmi0LziNhr6wOsgO9C1339vbGznnNAU2AM9Svk235cqKieKGkldAf7DGvTrjnjJnzyQoMu0ZTuZgUqvmlYR+f39XIE4uqCX1E/rDZpCYmKwOOmivAfYK9KF1AM7EdG4uAMLAOjmQideQXOJQkyUisqYiFRhtSFbxCxj8do0T30dmTvLhC+an0MZZVBHX09tBTG4qFigZEJEChjTIEwtRik81Qa7uOQU0IrYAe7FRjqYw6SlYjgAyN1GmHsFIGPfVnxzFuFITKEkfYK+oWZ5qKlIkcZ7UE92oXBmeIgIxtAO5UtSHqo9uiLW+sme5ejSIRASeAFR4LYy8MMzL1aq3EYWzJF28BgMEzGYpBkrMKelgl+P6uTcVY8NjLYyYPwMTCcufSaouH6al9xNJcjC82vDb9uVZKbrWIumNO+waVsu1TCC+Wxcg6xaSpsZSYM2wLO9/U8qZWH+wztQnsfAxV/E3MIKZVf1FsmJVV8mamhEmxZ0X7sSsABsGv1tZJGejmptU7FBUDYzPAXQBwFEEl+9+stFEroJEci2ELwIMmZuWoSTE9DYYcWVCjlJrZWMpeBhlAEqBiulPE84S3ixU5gSTwGGOdyEVNJXxA8nPevshwABHktBS1YoQ+QAAAABJRU5ErkJggg=='; // Set source path
                setInterval(draw,10);
            }
            var rotation = 0;
            function draw(){
                var ctx = document.getElementById('myCanvas').getContext('2d');
                ctx.globalCompositeOperation = 'destination-over';
                ctx.save();
                ctx.clearRect(0,0,27,27);
                ctx.translate(13.5,13.5); // to get it in the origin
                rotation +=1;
                ctx.rotate(rotation*Math.PI/64); //rotate in origin
                ctx.translate(-13.5,-13.5); //put it back
                ctx.drawImage(cog,0,0);
                ctx.restore();
            }
            init();
        </script>
    
  </body>
</html>
